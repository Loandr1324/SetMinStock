7. Добавляем другой алгоритм установки МО на складе 05 Павловский. Алгоритм называется Приоритетный склад по количеству или склад добора или склад хранения или оптовый склад.
7.1. Добавляем в работу программы возможность устанавливать разный срок дней запаса для Розничных магазинов и для Оптового склада(приоритетного по количеству).
7.1.1 По умолчанию срок устанавливается такой же как и для магазинов. В этом случае на Оптовый склад никаких МО добавляться не будет.
7.1.2. Если срок дней запаса Оптового склада > срока дней запаса для Розничных магазинов, то расчётное значение МО считается по следующему алгоритму.
Продажи всех Розничных магазинов делятся на количество дней анализа (по умолчанию 365) у умножаются на количество дней запаса для Оптового склада.
Далее из полученного значения вычитаются все расчётные значения Розничных магазинов и разница устанавливается на Оптовый склад.
Если разница будет меньше или равна 0, то устанавливается значения 0,96.
Разница меньше нуля может получиться из-за небольшой разницы в сроках, небольших продажах и при использовании кратности на подразделениях.
7.2. Так же оставляем возможность программе учитывать продажи самого Оптового склада для установки МО по желанию заказчика. Это задаётся при запуски программы.
В этом случае эти РЗ_МО будут добавляться к РЗ_МО полученных в п.7.1.
Так же, если и при добавлении этого значения РЗ_МО будет <= 0, то РЗ_МО устанавливаем  = 0,96.





Правила работы:
1. Все Файлы, которые выгружаются из базы, должны сохраняться в папку "Исходные данные".
2. В наименования файлах по продажам, должно быть слово "продажи".
Выгружаем продажи только из баз ШАВ, ШСВ и Оптовой(ТС или НТ).
3. В наименованиях файлов по МО, должно быть слово "МО".
Выгружаем МО из трёх баз ШАВ, ШСВ и Оптовой(ТС или НТ).
ШАВ и ШСВ выгружаем необходимый нам МО по одному из каждого подразделения.
ТС выгружаем один МО необходимый нам с 05 Павловский и один Компания MaCar МО внешний.
4. Чтобы не ошибиться с наименованием файлов рекомендуем пересохранять файлы из 1С в файлы из 
папки "Исходные данные" под теми же именами.
5. Запускаемый файл должен находится в той же папке, что и папка "Исходные данные".
6. Запускаем программу "Соединение_файлов_универсальная.exe" и действуем согласно Алгоритм работы с интерфейсом программы.
7. Программа создаст файл с именем "Анализ МО по компании.xlsx"

Алгоритм работы с интерфейсом программы:
1. Выбираем режим работы с Кратностью и Комплектностью.
1.1. Чтобы не учитывать Кратность и Комплектность нажимаем Enter. В этом режиме Программа в независимости от установленной Кратности и
Комплектности в файле принимает значение Кратности и Комплектности равной 1.
1.2. Если необходимо учитывать Кратность и Комплектность, то нажимаем 1. 
Далее выбираем режим работы с Кратностью и Комплектностью.
1.2.1. Нажимаем 1 для выбора режима - Присваиваем значение кратности программой. Комплектность не учитываем.
В этом режиме программа запросит какое значения Кратности установить.
В независимости от значения Кратности в файле программа будет брать установленное значение Кратности из прораммы.
В независимости от значения Комплектности в файле программа будет брать значение равное 1.
1.2.2. Нажимаем 2 для выбора режима - Ограничиваем максимальное значение Кратности и Комплектности.
Далее программа запрашивает, какие максимальные значения Кратности и Комплектности установить.
В этом режиме учитывается значения Кратности и Комплектности полученные из файла, но не более чем установленные в
программе.
1.3. Вводим приоритетный склад из списка: 01 Кирова, 02 Автолюбитель, 03 Интер, 04 Победа, 08 Центр, 09 Вокзалка.
Если приоритетный склад устанавливать не требуется, то нажимаем Enter.
1.4. Программа запрашивает надо ли изменить значения по периодам анализа продаж и дней запаса. По умолчанию используются
значения (кол-во дней анализируемых продаж = 365, кол-во дней запаса = 90).
1.4.1. Если изменять не требуется, то нажимаем Enter.
1.4.2. Если требуется изменить, то вводим 1. И далее вводим новые значения кол-ва дней.
1.5. Программа запрашивает, требуется ли учитывать продажи оптового склада. Если требуется, то вводим 1. Если не
требуется, то нажимаем Enter.

Алгоритм расчёта МО в программе:
Кратко:
Т.к. алгоритм расчёта уже сложен для быстрого восприятия, то кратко без деталей он выглядит следующим образом.
Рассчитываем планируемые значения МО на Розничных складах = Продажи / 365 * 90.
На Павловском устанавливаем значения на основании продаж по всем розничным складам.
В программе есть возможность указать приоритетный склад, выбрать режимы работы с Кратностью и Комплектностью.
А так же возможность учитывать продажи оптового склада и добавлять его расчётные значения к уже проставленным на
основании Розничных продаж.
Детально:
1. Составляем список файлов, которые будут загружаться в программу. Если не требуется учитывать продажи оптового склада,
то программа исключает из списка файлов по продажам файл, в наименовании которого содержится "техснаб" в любом регистре.
1.1. Считываем все файлы и по файлам продаж создаём колонки "[Наименование склада] МО расчёт" и "Компания MaCar продажи".
2. Все колонки Кратность и Комплектность из всех файлов "продаж" объединяем. И помещаем в отдельную таблицу.
2.1. Если используется установка Кратности программой, то устанавливаем в таблице Кратности и Кмоплектности это значение.
2.2. Если не используется установка Кратности, то ограничиваем значение кратности введённым максимальным значением Кратности.
По умолчанию 1.
2.3. Ограничиваем максимальное значение Комплектности. По умолчанию 1.
3. Считаем общие продажи как сумму продаж по всем розничным складам кроме продаж на 05 Павловский.
Задаём название колонки "Розн. продажи MaCar"
3. Вычисляем расчётное значение МО по продажам подразделений.
3.1. Суммируем все значения по складам отдельного подразделения (основной, возврат и т.п.), которые есть в файле.
3.2. Рассчитываем значения исходя из периода анализируемых продажи и периода запасов.
Делим продажи каждого магазина на количество анализируемых дней продаж (365) и умножаем на количество дней запаса (90).
Округляем в меньшую сторону.
3.3. Обнуляем все рассчитанные МО меньше 0.
3.4. По всем колонкам, кроме '05 Павловский МО расчёт' приводим все рассчитанные значения согласно правилам Кратности и Комплектности
3.4.1. Если расчётные значения меньше значения Кратности, но больше 0, то устанавливаем значения Кратности.
3.4.2. Если расчётные значения после установки Кратности меньше значения Комплектности, но больше 0,
то устанавливаем значения Комплектности.
3.4.3. Все значения, которые больше комплектности приводим к значению кратному значению Кратности.
Т.е. Значение делим на Кратность. Округляем до целого числа по математическим правилам. Умножаем на Кратность.

4. Далее корректируем расчётные значения МО на розничных складах согласно сумме продаж по всем Розничным складам.
Если на проверяемом складе уже установлено 0 < МО < 1, то значения не меняем ни в каком случае.
Даже если при расчете получается МО = 0,5. Это связано с тем, что сотрудники могут специально поставить какое-то служебное значение,
например для нового товара.
6. Если розничные продажи по всей компании равны 0, то на всех розничных складах устанавливаем 0,5.
7. Если розничные продажи по всей компании равны 1, то устанавливаем МО = 1 на приоритетном складе.
На остальных розничных складах 0,33.
8. Если розничные продажи по всей компании равны 2
8.1. Если продажа 2шт. была на одном складе, то устанавливаем МО = 1 только на этом складе.
8.2. Если эти продажи были на разных складах, то устанавливаем МО = 1 на Приоритетном складе и МО=1 на один из складов,
на котором была продаж по приоритету:
['01 Кирова МО расчёт', '03 Интер МО расчёт', '04 Победа МО расчёт', '08 Центр МО расчёт', '09 Вокзалка МО расчёт'],
на остальных складах устанавливаем МО = 0,33.
Если на складе по приоритету, где были продажи, значение 0 < МО < 1, то его пропускаем и ставим МО = 1 на следующем
складе, где были продажи согласно приоритету (если на нём это позволяет значение МО).
8.3. Если продажа была на Автолюбителе, то устанавливаем МО согласно продажам. Где продаж не было устанавливаем МО = 0,33.
9. Если продажи по всей компании от 2 до 10 и на каком-то складе нет продаж, то устанавливаем на этом складе 0,33.
10. Если продажи по всей компании кроме 05 Павловский >= 10, то на всех складах, где расчет МО = 0 устанавливаем 1.
11. Устанавливаем МО в колонку "05 Павловский расчет".
11.1. Если продажи по всей компании кроме 05 Павловский >= 25, то устанавливаем значение в колонку "05 Павловский расчет"
равное (Общая сумма продаж делённое нацело на 10).
Пример:
25 = 2
29 = 2
30 = 3
206 = 20
271 = 27
Если установлен режим "учитывать продажи на оптовом складе", то добавляем к этому значению расчётные значения исходя из
продаж по этому складу.
11.2.  Если продажи по всей компании кроме 05 Павловский < 25, то устанавливаем значение в колонку 05 Павловский расчет
равное 0.
Если установлен режим "учитывать продажи на оптовом складе", то добавляем к этому значению расчётные значения исходя из
продаж по этому складу.
11.3. Если значение в этой колонке получилось > 0 и меньше значения Кратности, то устанавливаем значение Кратности.
11.4. Если далее значение > 0 и меньше значения Комплектности, то устанавливаем значения Комплектности.
11.5. Все значение которые больше комплектности приводим к значению кратному значению кратности.
Т.е. Значение делим на Кратность и округляем до целого значения по математическим правилам. Далее умножаем на Кратность.
11.6. Если продажи по Розничным магазинам равны 0, то в этой колонке устанавливаем 0,5.
11.7. Если МО по этому складу установлено 0 < МО < 1, то в расчётное значение устанавливаем значение МО.
12. Устанавливаем значения в колонку "Компания MaCar МО расчёт".
12.1. Суммируем целые числа со всех колонок "... МО расчёт", включая "05 Павловский расчет" и подставляем это значение в колонку "Компания MaCar МО расчёт"
12.2. Проверяем, если продажи по всей компании = 0, то в колонку "Компания MaCar МО расчёт" подставляем значение 0.5.
12.3. Если МО в колонке "Компания MaCar МО" > 0 и < 1, то устанавливаем значение этого МО.

